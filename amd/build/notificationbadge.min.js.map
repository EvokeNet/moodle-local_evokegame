{"version":3,"file":"notificationbadge.min.js","sources":["../src/notificationbadge.js"],"sourcesContent":["/**\n * Delete badge js logic.\n *\n * @package    local_evokegame\n * @copyright  2021 World Bank Group <https://worldbank.org>\n * @author     Willian Mano <willianmanoaraujo@gmail.com>\n */\n\ndefine([\n    'jquery',\n    'core/ajax',\n    'core/config',\n    'core/modal_factory',\n    'local_evokegame/sweetalert',\n    'local_evokegame/modal_notificationbadge'],\n    function($, Ajax, Config, ModalFactory, Swal, ModalNotificationBadge) {\n\n    var NotificationBadge = function() {\n        this.checkIfHasNotification();\n    };\n\n    NotificationBadge.prototype.checkIfHasNotification = function() {\n        var request = Ajax.call([{\n            methodname: 'local_evokegame_checknotificationbadge',\n            args: {}\n        }]);\n\n        request[0].done(function(result) {\n            if (result.status == true) {\n                ModalFactory.create({\n                    type: ModalNotificationBadge.TYPE,\n                    templateContext: {\n                        isachievement: result.isachievement,\n                        badgename: result.badgename,\n                        badgeimage: result.badgeimage,\n                        courseid: result.courseid,\n                        profileurl: Config.wwwroot + '/local/evokegame/profile.php?id=' + result.courseid\n                    }\n                }).then(function(modal) {\n                    return modal.show();\n                });\n            }\n        }.bind(this)).fail(function(error) {\n            var message = error.message;\n\n            if (!message) {\n                message = error.error;\n            }\n            this.showToast('error', message);\n        }.bind(this));\n    };\n\n    NotificationBadge.prototype.showToast = function(type, message) {\n        var Toast = Swal.mixin({\n            toast: true,\n            position: 'top-end',\n            showConfirmButton: false,\n            timer: 8000,\n            timerProgressBar: true,\n            onOpen: (toast) => {\n                toast.addEventListener('mouseenter', Swal.stopTimer);\n                toast.addEventListener('mouseleave', Swal.resumeTimer);\n            }\n        });\n\n        Toast.fire({\n            icon: type,\n            title: message\n        });\n    };\n\n    return {\n        'init': function() {\n            return new NotificationBadge();\n        }\n    };\n});"],"names":["define","$","Ajax","Config","ModalFactory","Swal","ModalNotificationBadge","NotificationBadge","checkIfHasNotification","prototype","call","methodname","args","done","result","status","create","type","TYPE","templateContext","isachievement","badgename","badgeimage","courseid","profileurl","wwwroot","then","modal","show","bind","this","fail","error","message","showToast","mixin","toast","position","showConfirmButton","timer","timerProgressBar","onOpen","addEventListener","stopTimer","resumeTimer","fire","icon","title"],"mappings":"AAQAA,2CAAO,CACH,SACA,YACA,cACA,qBACA,6BACA,4CACA,SAASC,EAAGC,KAAMC,OAAQC,aAAcC,KAAMC,4BAE1CC,kBAAoB,gBACfC,iCAGTD,kBAAkBE,UAAUD,uBAAyB,WACnCN,KAAKQ,KAAK,CAAC,CACrBC,WAAY,yCACZC,KAAM,MAGF,GAAGC,KAAK,SAASC,QACA,GAAjBA,OAAOC,QACPX,aAAaY,OAAO,CAChBC,KAAMX,uBAAuBY,KAC7BC,gBAAiB,CACbC,cAAeN,OAAOM,cACtBC,UAAWP,OAAOO,UAClBC,WAAYR,OAAOQ,WACnBC,SAAUT,OAAOS,SACjBC,WAAYrB,OAAOsB,QAAU,mCAAqCX,OAAOS,YAE9EG,MAAK,SAASC,cACNA,MAAMC,WAGvBC,KAAKC,OAAOC,KAAK,SAASC,WACpBC,QAAUD,MAAMC,QAEfA,UACDA,QAAUD,MAAMA,YAEfE,UAAU,QAASD,UAC1BJ,KAAKC,QAGXvB,kBAAkBE,UAAUyB,UAAY,SAASjB,KAAMgB,SACvC5B,KAAK8B,MAAM,CACnBC,OAAO,EACPC,SAAU,UACVC,mBAAmB,EACnBC,MAAO,IACPC,kBAAkB,EAClBC,OAASL,QACLA,MAAMM,iBAAiB,aAAcrC,KAAKsC,WAC1CP,MAAMM,iBAAiB,aAAcrC,KAAKuC,gBAI5CC,KAAK,CACPC,KAAM7B,KACN8B,MAAOd,WAIR,MACK,kBACG,IAAI1B"}