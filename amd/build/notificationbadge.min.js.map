{"version":3,"file":"notificationbadge.min.js","sources":["../src/notificationbadge.js"],"sourcesContent":["/**\n * Delete badge js logic.\n *\n * @copyright  2021 World Bank Group <https://worldbank.org>\n * @author     Willian Mano <willianmanoaraujo@gmail.com>\n */\n\ndefine([\n    'jquery',\n    'core/ajax',\n    'core/config',\n    'local_evokegame/sweetalert',\n    'local_evokegame/modal_notificationbadge'],\n    function($, Ajax, Config, Swal, ModalNotificationBadge) {\n\n    var NotificationBadge = function() {\n        this.checkIfHasNotification();\n    };\n\n    NotificationBadge.prototype.checkIfHasNotification = function() {\n        var request = Ajax.call([{\n            methodname: 'local_evokegame_checknotificationbadge',\n            args: {}\n        }]);\n\n        request[0].done(function(result) {\n            if (result.status == true) {\n                // Generate a unique ID for the modal\n                var uniqid = 'evokegame-badge-notification-' + Math.random().toString(36).substr(2, 9);\n\n                ModalNotificationBadge.create({\n                    templateContext: {\n                        uniqid: uniqid,\n                        isachievement: result.isachievement || false,\n                        badgename: result.badgename || 'Badge',\n                        badgeimage: result.badgeimage || '',\n                        courseid: result.courseid || 0,\n                        profileurl: Config.wwwroot + '/local/evokegame/profile.php?id=' +\n                            (result.courseid || 0),\n                        title: result.title || (result.isachievement ?\n                            'You\\'ve earned an achievement!' : 'You\\'ve earned a badge!'),\n                        description: result.description || '',\n                        buttontext: result.buttontext || 'Check your scoreboard',\n                        closetext: result.closetext || 'Close',\n                        classes: 'evoke-game-badge-modal',\n                        headerclasses: '',\n                        footer: ''\n                    },\n                    large: true,\n                    removeOnClose: true,\n                    show: true\n                }).catch(function(error) {\n                    this.showToast('error', 'Failed to display badge notification');\n                }.bind(this));\n            }\n        }.bind(this)).fail(function(error) {\n            var message = error.message;\n\n            if (!message) {\n                message = error.error;\n            }\n            this.showToast('error', message);\n        }.bind(this));\n    };\n\n    NotificationBadge.prototype.showToast = function(type, message) {\n        var Toast = Swal.mixin({\n            toast: true,\n            position: 'top-end',\n            showConfirmButton: false,\n            timer: 8000,\n            timerProgressBar: true,\n            onOpen: (toast) => {\n                toast.addEventListener('mouseenter', Swal.stopTimer);\n                toast.addEventListener('mouseleave', Swal.resumeTimer);\n            }\n        });\n\n        Toast.fire({\n            icon: type,\n            title: message\n        });\n    };\n\n    return {\n        'init': function() {\n            return new NotificationBadge();\n        }\n    };\n});"],"names":["define","$","Ajax","Config","Swal","ModalNotificationBadge","NotificationBadge","checkIfHasNotification","prototype","call","methodname","args","done","result","status","uniqid","Math","random","toString","substr","create","templateContext","isachievement","badgename","badgeimage","courseid","profileurl","wwwroot","title","description","buttontext","closetext","classes","headerclasses","footer","large","removeOnClose","show","catch","error","showToast","bind","this","fail","message","type","mixin","toast","position","showConfirmButton","timer","timerProgressBar","onOpen","addEventListener","stopTimer","resumeTimer","fire","icon"],"mappings":"AAOAA,2CAAO,CACH,SACA,YACA,cACA,6BACA,4CACA,SAASC,EAAGC,KAAMC,OAAQC,KAAMC,4BAE5BC,kBAAoB,gBACfC,iCAGTD,kBAAkBE,UAAUD,uBAAyB,WACnCL,KAAKO,KAAK,CAAC,CACrBC,WAAY,yCACZC,KAAM,MAGF,GAAGC,KAAK,SAASC,WACA,GAAjBA,OAAOC,OAAgB,KAEnBC,OAAS,gCAAkCC,KAAKC,SAASC,SAAS,IAAIC,OAAO,EAAG,GAEpFd,uBAAuBe,OAAO,CAC1BC,gBAAiB,CACbN,OAAQA,OACRO,cAAeT,OAAOS,gBAAiB,EACvCC,UAAWV,OAAOU,WAAa,QAC/BC,WAAYX,OAAOW,YAAc,GACjCC,SAAUZ,OAAOY,UAAY,EAC7BC,WAAYvB,OAAOwB,QAAU,oCACxBd,OAAOY,UAAY,GACxBG,MAAOf,OAAOe,QAAUf,OAAOS,cAC3B,gCAAmC,0BACvCO,YAAahB,OAAOgB,aAAe,GACnCC,WAAYjB,OAAOiB,YAAc,wBACjCC,UAAWlB,OAAOkB,WAAa,QAC/BC,QAAS,yBACTC,cAAe,GACfC,OAAQ,IAEZC,OAAO,EACPC,eAAe,EACfC,MAAM,IACPC,MAAM,SAASC,YACTC,UAAU,QAAS,yCAC1BC,KAAKC,SAEbD,KAAKC,OAAOC,KAAK,SAASJ,WACpBK,QAAUL,MAAMK,QAEfA,UACDA,QAAUL,MAAMA,YAEfC,UAAU,QAASI,UAC1BH,KAAKC,QAGXpC,kBAAkBE,UAAUgC,UAAY,SAASK,KAAMD,SACvCxC,KAAK0C,MAAM,CACnBC,OAAO,EACPC,SAAU,UACVC,mBAAmB,EACnBC,MAAO,IACPC,kBAAkB,EAClBC,OAASL,QACLA,MAAMM,iBAAiB,aAAcjD,KAAKkD,WAC1CP,MAAMM,iBAAiB,aAAcjD,KAAKmD,gBAI5CC,KAAK,CACPC,KAAMZ,KACNjB,MAAOgB,WAIR,MACK,kBACG,IAAItC"}