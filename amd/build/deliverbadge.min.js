define ("local_evokegame/deliverbadge",["jquery","core/ajax","core/str","local_evokegame/sweetalert"],function(a,b,c,d){var e={CONFIRM_TITLE:"Are you sure?",CONFIRM_MSG:"Once delivered, the badge cannot be revoked!",CONFIRM_YES:"Yes, deliver it!",CONFIRM_NO:"Cancel",SUCCESS:"Chapter successfully delivered."},f=[{key:"deliverbadge_confirm_title",component:"local_evokegame"},{key:"deliverbadge_confirm_msg",component:"local_evokegame"},{key:"deliverbadge_confirm_yes",component:"local_evokegame"},{key:"deliverbadge_confirm_no",component:"local_evokegame"},{key:"deliverbadge_success",component:"local_evokegame"}],g=function(){this.getStrings();a("body").append("<div id=\"evokegame-fullscreenloading\"></div>");this.registerEventListeners()};g.prototype.getStrings=function(){var b=c.get_strings(f);a.when(b).done(function(a){e.CONFIRM_TITLE=a[0];e.CONFIRM_MSG=a[1];e.CONFIRM_YES=a[2];e.CONFIRM_NO=a[3];e.SUCCESS=a[4]})};g.prototype.registerEventListeners=function(){a("body").on("click",".deliver-evokegame-badge",function(b){b.preventDefault();var c=a(b.currentTarget);d.fire({title:e.CONFIRM_TITLE,text:e.CONFIRM_MSG,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:e.CONFIRM_YES,cancelButtonText:e.CONFIRM_NO}).then(function(a){if(a.value){this.callDelivery(c)}}.bind(this))}.bind(this))};g.prototype.callDelivery=function(c){a("#evokegame-fullscreenloading").show();var d=b.call([{methodname:"local_evokegame_deliverbadge",args:{badge:{id:c.data("id")}}}]);d[0].done(function(a){this.reloadPage(a.message)}.bind(this)).fail(function(b){a("#evokegame-fullscreenloading").hide();var c=b.message;if(!c){c=b.error}this.showToast("error",c)}.bind(this))};g.prototype.reloadPage=function(b){a("#evokegame-fullscreenloading").hide();this.showToast("success",b)};g.prototype.showToast=function(a,b){var c=d.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:8e3,timerProgressBar:!0,onOpen:function onOpen(a){a.addEventListener("mouseenter",d.stopTimer);a.addEventListener("mouseleave",d.resumeTimer)}});c.fire({icon:a,title:b})};return{init:function init(){return new g}}});
//# sourceMappingURL=deliverbadge.min.js.map
