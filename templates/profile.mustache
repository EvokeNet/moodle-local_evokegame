<div class="evokegame-profile">
    <div class="row">
        <div class="col-md-3">
            <div class="card">
                <div class="card-body">
                    <div class="userpicture" data-action="choose-avatar-modal">
                        <img id="evokegame-user-avatar" src="{{{useravatar}}}" alt="{{{userfirstname}}}">
                    </div>

                    <h2 class="text-center">{{firstname}}</h2>

                    {{#itsme}}
                        <div class="actions text-center">
                            <button type="button" class="btn btn-primary btn-sm mt-1" data-action="choose-avatar-modal">
                                <i class="fa fa-user-circle-o"></i> {{#str}}updateavatar, local_evokegame{{/str}}
                            </button>

                            <a type="button" class="btn btn-secondary btn-sm mt-1" href="{{config.wwwroot}}/user/edit.php?id={{id}}&returnto=profile">
                                <i class="fa fa-pencil-square-o"></i> {{#str}}editprofile, local_evokegame{{/str}}
                            </a>
                        </div>
                    {{/itsme}}

                    <h3 class="mt-3">{{#str}}aboutme, local_evokegame{{/str}}</h3>

                    <p class="text-muted mb-2">
                        <strong>{{#str}}fullname, local_evokegame{{/str}}</strong> <span class="ms-2">{{firstname}} {{lastname}}</span>
                    </p>
                    <p class="text-muted mb-2">
                        <strong>{{#str}}email, local_evokegame{{/str}}</strong> <span class="ms-2">{{email}}</span>
                    </p>

                    <hr>

                    <div class="navigation text-center">
                        <a href="{{{config.wwwroot}}}/course/view.php?id={{{courseid}}}" class="btn btn-primary btn-sm mt-1">
                            {{#str}}backtomission, local_evokegame{{/str}}
                        </a>
                        <a href="{{{config.wwwroot}}}/local/evokegame/scoreboard.php?id={{{courseid}}}" class="btn btn-primary btn-sm mt-1">
                            {{#str}}totheleaderboard, local_evokegame{{/str}}
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-9">
            <div class="card">
                <div class="card-body">
                    <h2>{{#str}}course{{/str}}: {{coursename}}</h2>

                    {{#hasbadges}}
                        <div class="row mt-2">
                            <div class="col">
                                <h4>{{#str}}badges{{/str}}</h4>
                                {{#badges}}
                                    <div class="d-flex align-items-center border p-2 my-2">
                                        <img src="{{{badgeimage}}}" alt="{{{name}}}" class="evokebadge">
                                        <div class="info ml-2 w-100">
                                            <h5>{{{name}}}</h5>
                                            <p>{{{description}}}</p>
                                            <p class="border-bottom mb-0">
                                                <b>{{#str}}badgecriterias, local_evokegame{{/str}}</b>
                                            </p>
                                            {{#criteriasprogress}}
                                                {{{.}}}
                                            {{/criteriasprogress}}
                                        </div>
                                    </div>
                                {{/badges}}
                            </div>
                        </div>
                    {{/hasbadges}}

                    {{#hasskills}}
                        <div class="row">
                            <div class="col">
                                <h4>{{#str}}myskills, local_evokegame{{/str}}</h4>
                                <table id="skillsstable" class="table table-bordered">
                                    <tbody>
                                    {{#skills}}
                                        <tr>
                                            <td class="badge-image-column">
                                                {{{skill}}}
                                            </td>
                                            <td style="width: 70%;">
                                                <div class="progress mb-0 ml-0" style="width: initial;">
                                                    <div class="progress-bar progress-bar-striped {{{progressbg}}}" role="progressbar" style="width: {{{percentpoints}}}%;" aria-valuenow="{{{percentpoints}}}" aria-valuemin="0" aria-valuemax="{{{totalpoints}}}">{{{userpoints}}} {{#str}}points, local_evokegame{{/str}}</div>
                                                </div>
                                            </td>
                                        </tr>
                                    {{/skills}}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    {{/hasskills}}

                    {{^hasskills}}
                        <div class="alert alert-info mb-0" role="alert">
                            <h3>{{#str}}progressdidnotstarted, local_evokegame{{/str}}</h3>

                            <p class="mb-0">{{#str}}progressdidnotstarted_desc, local_evokegame{{/str}}</p>
                        </div>
                    {{/hasskills}}

                    {{#hasachievements}}
                        <div class="row mt-2">
                            <div class="col">
                                <h4>{{#str}}myachievements, local_evokegame{{/str}}</h4>
                                <table id="achievementstable" class="table">
                                    <tbody>
                                    {{#achievements}}
                                        <tr>
                                            <td class="badge-image-column">
                                                <img src="{{{badgeimage}}}" alt="{{{name}}}" class="evokebadge">
                                            </td>
                                            <td>
                                                <h5>{{{name}}}</h5>
                                                <p>{{{description}}}</p>
                                            </td>
                                        </tr>
                                    {{/achievements}}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    {{/hasachievements}}
                </div>
            </div>
        </div>
    </div>
</div>

{{#itsme}}
    {{#js}}
        require(['local_evokegame/chooseavatar', 'local_evokegame/notificationbadge'], function(ChooseAvatar, NotificationBadge) {
            ChooseAvatar.init('[data-action=choose-avatar-modal]', {{{contextid}}});

            NotificationBadge.init();
        });
    {{/js}}
{{/itsme}}